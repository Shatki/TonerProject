{% load staticfiles %}

{% block popup-menu %}
    <div id="mm" class="easyui-menu" style="width:120px;">
        <div data-options="iconCls:'icon-add'" onclick="popupMenuDispatcher(1);">Создать</div>
        <div data-options="iconCls:'icon-edit'" onclick="popupMenuDispatcher(2);">Изменить</div>
        <div data-options="iconCls:'icon-remove'" onclick="popupMenuDispatcher(3);">Удалить</div>
        <div onclick="closeTab()">Закрыть</div>
        <div data-options="iconCls:'icon-reload'" onclick="javascript:reload();">Обновить</div>
        <div>
            <span>Экспорт</span>

            <div style="width:150px;">
                <div><b>Word</b></div>
                <div>Excel</div>
                <div>PowerPoint</div>
                <div>
                    <span>M1</span>

                    <div style="width:120px;">
                        <div>sub1</div>
                        <div>sub2</div>
                        <div>
                            <span>Sub</span>

                            <div style="width:80px;">
                                <div onclick="javascript:alert('sub21')">sub21</div>
                                <div>sub22</div>
                                <div>sub23</div>
                            </div>
                        </div>
                        <div>sub3</div>
                    </div>
                </div>
                <div>
                    <span>Window Demos</span>

                    <div style="width:120px;">
                        <div data-options="href:'window.html'">Window</div>
                        <div data-options="href:'dialog.html'">Dialog</div>
                        <div><a href="http://www.jeasyui.com" target="_blank">EasyUI</a></div>
                    </div>
                </div>
            </div>
        </div>
        <div data-options="iconCls:'icon-save'">Save</div>
        <div data-options="iconCls:'icon-print',disabled:true">Print</div>
        <div class="menu-sep"></div>
        <div>Exit</div>
    </div>

    <script>
        $(function () {
            $(document).bind('contextmenu', function (e) {
                e.preventDefault();
                $('#mm').menu('show', {
                    left: e.pageX,
                    top: e.pageY
                });
            });
        });

        function popupMenuDispatcher(action) {
            var tab = $('#doc-tab');
            var selected = tab.tabs('getSelected');
            var tabIndex = tab.tabs('getTabIndex', selected);
            //alert(tabIndex);
            if (tabIndex) {
                // Действия с документами
                switch (action) {
                    case 1:
                        addItem($("<div/>",
                                {"html": selected.panel('options').content}).find('#consignment-id').html());
                        break;
                    case 2:
                        editItem($("<div/>",
                                {"html": selected.panel('options').content}).find('#consignment-id').html());
                        break;
                    case 3:
                        deleteItem($("<div/>",
                                {"html": selected.panel('options').content}).find('#consignment-id').html());
                        break;
                    default:
                        break;
                }
            } else {
                switch (action) {
                    case 1:
                        newDocument();
                        break;
                    case 2:
                        editDocument();
                        break;
                    case 3:
                        destroyDocument();
                        break;
                    default:
                        break;
                }
            }
        }
    </script>
{% endblock popup-menu %}